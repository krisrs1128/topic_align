---
title: "Simulations"
output:
  pdf_document:
    template: notes/style.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 2)
```

```{r}
library("MASS")
library("MCMCpack")
library("dplyr")
library("ggplot2")
library("magrittr")
library("purrr")
library("stringr")
library("superheat")
library("tidyr")
library("topicmodels")
source("R_LSY/align_topics_all_functions.R")
source("simulation_functions.R")
(theme_minimal() + 
  theme(
    panel.grid.minor = element_blank(),
    panel.background = element_rect(fill = "#f7f7f7"),
    panel.border = element_rect(fill = NA, color = "#0c0c0c", size = 0.6),
    legend.position = "bottom"
  )) %>%
  theme_set()
```

```{r}
K <- 10
V <- 500
lambda_beta <- 1
B <- rdirichlet(K, rep(lambda_beta, V))
```

```{r, fig.width = 8, fig.height = 8}
B_tilde <- perturb_topics(B)
head(B_tilde)
```

```{r, fig.height = 6, fig.width = 20}
x <- equivalence_data(1000, 100, 6, list(beta = 1, gamma = 0.1))
superheat(log(1 + x), pretty.order.rows = TRUE)
```
```{r}
vis_wrapper(x, 12)
```

